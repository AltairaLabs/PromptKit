---
import { getCollection } from 'astro:content';
import type { GetStaticPaths } from 'astro';
import DocsLayout from '../../layouts/DocsLayout.astro';
import Sidebar from '../../components/Sidebar.astro';
import TableOfContentsStatic from '../../components/TableOfContentsStatic.astro';

export const getStaticPaths = (async () => {
  const apiEntries = await getCollection('api');
  return apiEntries
    .filter(entry => entry.slug !== 'index')
    .map(entry => ({
      params: { slug: entry.slug },
      props: { entry },
    }));
}) satisfies GetStaticPaths;

const { entry } = Astro.props;
const { Content, headings } = await entry.render();
---

<DocsLayout 
  title={entry.data.title} 
  description={entry.data.description}
  product="api"
>
  <Sidebar slot="sidebar" product="api" currentPath={Astro.url.pathname} />
  
  <Content />
  
  <TableOfContentsStatic slot="toc" headings={headings} />
</DocsLayout>
