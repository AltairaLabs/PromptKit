---
import { getCollection } from 'astro:content';
import DocsLayout from '../../layouts/DocsLayout.astro';
import Sidebar from '../../components/Sidebar.astro';

const apiIndex = await getCollection('api', ({ id }) => id === 'index.md' || id === 'index');
const indexEntry = apiIndex[0];

let title = 'API Reference';
let description = 'Complete API documentation';
let Content;

if (indexEntry) {
  const rendered = await indexEntry.render();
  Content = rendered.Content;
  title = indexEntry.data.title || title;
  description = indexEntry.data.description || description;
}
---

<DocsLayout 
  title={title}
  description={description}
  product="api"
>
  <Sidebar slot="sidebar" product="api" currentPath={Astro.url.pathname} />
  
  {Content ? <Content /> : (
    <div>
      <h1>ðŸ“š {title}</h1>
      <p class="lead">{description}</p>
      <p>Select an API reference from the sidebar to get started.</p>
    </div>
  )}
</DocsLayout>

<style>
  .lead {
    font-size: 1.25rem;
    margin-bottom: 2rem;
    color: #57606a;
  }

  @media (prefers-color-scheme: dark) {
    .lead {
      color: #8b949e;
    }
  }
</style>
