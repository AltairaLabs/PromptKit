<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f7fa;
        }
        
        .header {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .header-logo {
            width: 48px;
            height: 48px;
            flex-shrink: 0;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0;
        }

        .header .subtitle {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .summary {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .summary h2 {
            color: #4a5568;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .stat-card {
            text-align: center;
            padding: 1.5rem;
            border-radius: 8px;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: #718096;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .matrix-section {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .matrix-section h2 {
            color: #4a5568;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .scenario-group {
            background: white;
            border-radius: 12px;
            padding: 0;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .scenario-header {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
            color: white;
            padding: 1.25rem 1.5rem;
            cursor: pointer;
            user-select: none;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: opacity 0.2s;
        }
        
        .scenario-header:hover {
            opacity: 0.9;
        }
        
        .scenario-header .collapse-icon {
            font-size: 1.2rem;
            color: white;
            transition: transform 0.2s;
        }
        
        .scenario-group.collapsed .scenario-header .collapse-icon {
            transform: rotate(-90deg);
        }
        
        .scenario-title {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .scenario-content {
            padding: 1.5rem;
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
            overflow: hidden;
        }
        
        .scenario-group.collapsed .scenario-content {
            max-height: 0;
            opacity: 0;
            padding-top: 0;
            padding-bottom: 0;
        }
        
        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .matrix-table th,
        .matrix-table td {
            padding: 1rem;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        
        .matrix-table th {
            background: #4a5568;
            color: white;
            font-weight: 600;
        }
        
        .matrix-table th:first-child {
            background: #2d3748;
        }
        
        .matrix-cell {
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 0.25rem;
        }
        
        .matrix-cell.success {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
        }
        
        .matrix-cell.error {
            background: linear-gradient(135deg, #f56565, #e53e3e);
            color: white;
        }
        
        .matrix-cell.empty {
            background: #f7fafc;
            color: #a0aec0;
        }
        
        .scenario-count {
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .success-rate {
            font-size: 0.8rem;
            opacity: 0.9;
        }
        
        .cost-info {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .results-section {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .results-section h2 {
            color: #4a5568;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .result-card {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 1rem;
            overflow: hidden;
        }
        
        .result-header {
            padding: 1rem;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }
        
        .result-header:hover {
            background: #f1f5f9;
        }
        
        .result-header-left {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .collapse-icon {
            font-size: 1.2rem;
            color: #718096;
            transition: transform 0.2s;
        }
        
        .result-header.collapsed .collapse-icon {
            transform: rotate(-90deg);
        }
        
        .result-title {
            font-weight: 600;
            color: #2d3748;
        }
        
        .result-content {
            padding: 1rem;
            transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
            overflow: hidden;
        }
        
        .result-card.collapsed .result-content {
            max-height: 0;
            opacity: 0;
            padding-top: 0;
            padding-bottom: 0;
        }
        
        .matrix-cell {
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 0.25rem;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        
        .matrix-cell:hover {
            opacity: 0.8;
        }
        
        .result-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .result-status.success {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .result-status.error {
            background: #fed7d7;
            color: #742a2a;
        }
        
        .result-content {
            padding: 1rem;
        }
        
        .conversation {
            margin-bottom: 1rem;
        }
        
        .turn {
            margin-bottom: 1rem;
            padding: 0.75rem;
            border-radius: 6px;
            position: relative;
        }
        
        .turn.has-failures {
            border: 2px solid #ef4444 !important;
        }
        
        .turn.user {
            background: #ebf8ff;
            border-left: 4px solid #3182ce;
        }
        
        .turn.assistant {
            background: #f0fff4;
            border-left: 4px solid #38a169;
        }
        
        .turn.system {
            background: #faf5ff;
            border-left: 4px solid #805ad5;
        }


        
        .turn.tool {
            background: #fff5f0;
            border-left: 4px solid #fd7f28;
        }
        
        .turn-role {
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
        }
        
        .turn-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .ai-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            color: #6b7280;
            font-weight: 500;
        }
        
        .ai-icon {
            font-size: 0.9rem;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .persona-name {
            background: #f3f4f6;
            padding: 0.125rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            color: #374151;
        }
        
        .turn-content {
            line-height: 1.5;
        }
        
        .turn-content ol {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }
        
        .turn-content ul {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }
        
        .turn-content li {
            margin: 0.25rem 0;
        }
        
        .turn-content p {
            margin: 0.5rem 0;
        }
        
        .turn-content p:first-child {
            margin-top: 0;
        }
        
        .turn-content p:last-child {
            margin-bottom: 0;
        }
        
        .turn-content strong {
            font-weight: 600;
        }
        
        .turn-content em {
            font-style: italic;
        }
        
        .turn-content code {
            background: #f1f5f9;
            padding: 0.125rem 0.25rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .turn-content pre {
            background: #f1f5f9;
            padding: 0.75rem;
            border-radius: 6px;
            overflow-x: auto;
            margin: 0.5rem 0;
        }
        
        .turn-content pre code {
            background: none;
            padding: 0;
        }
        
        .tool-calls {
            margin-top: 1rem;
        }
        
        .tool-call {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
        }
        
        .tool-call:last-child {
            margin-bottom: 0;
        }
        
        .tool-call-header {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            cursor: pointer;
            user-select: none;
        }
        
        .tool-call-header:hover {
            opacity: 0.8;
        }
        
        .tool-call-name {
            background: #6366f1;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-weight: 600;
            margin-right: 0.5rem;
        }
        
        .tool-call-id {
            color: #718096;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }
        
        .tool-call-toggle {
            margin-left: auto;
            color: #718096;
            font-size: 0.8rem;
            transition: transform 0.2s;
        }
        
        .tool-call-toggle.expanded {
            transform: rotate(90deg);
        }
        
        .tool-call-args {
            background: #f1f5f9;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            padding: 0.75rem;
            margin-top: 0.75rem;
            display: none;
        }
        
        .tool-call-args.expanded {
            display: block;
        }
        
        .tool-call-args-label {
            font-size: 0.8rem;
            color: #4a5568;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .json-content {
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            color: #2d3748;
            line-height: 1.4;
        }
        
        .tool-response {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
        }
        
        .tool-response-header {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            cursor: pointer;
            user-select: none;
        }
        
        .tool-response-header:hover {
            opacity: 0.8;
        }
        
        .tool-response-name {
            background: #ed8936;
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-weight: 600;
            margin-right: 0.5rem;
        }
        
        .tool-response-id {
            color: #718096;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
        }
        
        .tool-response-toggle {
            margin-left: auto;
            color: #718096;
            font-size: 0.8rem;
            transition: transform 0.2s;
        }
        
        .tool-response-toggle.expanded {
            transform: rotate(90deg);
        }
        
        .tool-response-content {
            background: #fffaf0;
            border: 1px solid #fbd38d;
            border-radius: 4px;
            padding: 0.75rem;
            margin-top: 0.75rem;
            display: none;
        }
        
        .tool-response-content.expanded {
            display: block;
        }
        
        .tool-response-label {
            font-size: 0.8rem;
            color: #4a5568;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .raw-request-content {
            display: none;
            margin-top: 0.75rem;
        }

        .raw-request-content.expanded {
            display: block;
        }

        .available-tools-details {
            margin-top: 0.75rem;
            padding: 0.5rem 0.75rem;
            background: #f0f4ff;
            border: 1px solid #c7d2fe;
            border-radius: 6px;
            font-size: 0.85rem;
        }

        .available-tools-details summary {
            cursor: pointer;
            color: #4338ca;
            font-weight: 600;
            padding: 0.25rem 0;
        }

        .available-tools-details summary:hover {
            color: #3730a3;
        }

        .available-tools-details[open] {
            background: #eef2ff;
        }
        
        .turn-error {
            background: #fed7d7;
            border: 1px solid #fc8181;
            border-radius: 6px;
            padding: 0.75rem;
            margin: 0.5rem 0;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }
        
        .error-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        
        .error-details {
            flex: 1;
        }
        
        .error-type {
            font-weight: 600;
            color: #c53030;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }
        
        .error-message {
            color: #742a2a;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .metadata {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }
        
        .meta-item {
            text-align: center;
        }
        
        .meta-label {
            font-size: 0.8rem;
            color: #718096;
            margin-bottom: 0.25rem;
        }
        
        .meta-value {
            font-weight: 600;
            color: #2d3748;
        }
        
        .media-outputs-section {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }
        
        .media-outputs-header {
            font-size: 0.9rem;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 0.75rem;
        }
        
        .media-outputs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.75rem;
        }
        
        .media-output-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 0.75rem;
            transition: all 0.2s ease;
        }
        
        .media-output-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-color: #cbd5e0;
        }
        
        .media-output-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .media-icon {
            font-size: 1.2rem;
        }
        
        .media-type {
            font-weight: 600;
            font-size: 0.85rem;
            color: #4a5568;
            text-transform: capitalize;
        }
        
        .media-thumbnail {
            margin-bottom: 0.5rem;
            text-align: center;
            background: white;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .media-thumbnail img {
            max-width: 100%;
            max-height: 120px;
            display: block;
            margin: 0 auto;
        }
        
        .media-details {
            font-size: 0.8rem;
        }
        
        .media-detail-item {
            display: flex;
            justify-content: space-between;
            padding: 0.25rem 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .media-detail-item:last-child {
            border-bottom: none;
        }
        
        .media-detail-label {
            color: #718096;
            font-weight: 500;
        }
        
        .media-detail-value {
            color: #2d3748;
            font-weight: 600;
            text-align: right;
        }
        
        .media-filepath {
            font-family: 'Courier New', monospace;
        }
        
        /* Conversation Assertions Styles */
        .conversation-assertions-section {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }
        
        .conversation-assertions-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
            font-weight: 600;
            color: #4a5568;
        }
        
        .conversation-assertions-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 50%;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .conversation-assertions-badge.passed {
            background: #d1fae5;
            color: #065f46;
        }
        
        .conversation-assertions-badge.failed {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .conversation-assertions-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #4a5568;
        }
        
        .conversation-assertions-count {
            font-size: 0.8rem;
            color: #718096;
            margin-left: auto;
        }
        
        .conversation-assertions-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }
        
        .conversation-assertions-table thead th {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            text-align: left;
            font-weight: 600;
            color: #4a5568;
        }
        
        .conversation-assertions-table tbody td {
            border: 1px solid #e2e8f0;
            padding: 0.5rem;
            vertical-align: top;
        }
        
        .conversation-assertions-table tbody tr.passed {
            background: #f0fdf4;
        }
        
        .conversation-assertions-table tbody tr.failed {
            background: #fef2f2;
        }
        
        .assertion-index {
            font-weight: 500;
            color: #2d3748;
        }
        
        .assertion-status {
            white-space: nowrap;
        }
        
        .assertion-status .status-icon {
            display: inline-block;
            width: 1.2rem;
            height: 1.2rem;
            line-height: 1.2rem;
            text-align: center;
            border-radius: 50%;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .assertion-status .status-icon.passed {
            background: #d1fae5;
            color: #065f46;
        }
        
        .assertion-status .status-icon.failed {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .assertion-message {
            color: #2d3748;
            line-height: 1.4;
        }
        
        .assertion-details {
            font-size: 0.8rem;
        }
        
        .violation-summary {
            font-weight: 600;
            color: #991b1b;
            margin-bottom: 0.25rem;
        }
        
        .violations-list {
            list-style: none;
            padding-left: 0;
            margin: 0.25rem 0;
        }
        
        .violations-list li {
            margin: 0.5rem 0;
            padding: 0.5rem;
            background: #fef2f2;
            border-left: 3px solid #ef4444;
            border-radius: 0.25rem;
        }
        
        .violation-turn {
            font-weight: 600;
            color: #991b1b;
        }
        
        .violation-evidence {
            background: white;
            border: 1px solid #fecaca;
            border-radius: 0.25rem;
            padding: 0.5rem;
            margin-top: 0.5rem;
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
            overflow-x: auto;
        }
        
        .assertion-details-json {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.25rem;
            padding: 0.5rem;
            margin-top: 0.5rem;
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .error-message {
            background: #fed7d7;
            color: #742a2a;
            padding: 1rem;
            border-radius: 6px;
            margin-top: 1rem;
        }
        
        .validations-section {
            display: none;
            margin-top: 0.75rem;
            padding: 0.75rem;
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
        }
        
        .validations-section.expanded {
            display: block;
        }
        
        .validations-header {
            font-size: 0.85rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .validation-item {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
        }
        
        .validation-item:last-child {
            margin-bottom: 0;
        }
        
        .validation-item.passed {
            border-left: 4px solid #10b981;
            background: #f0fdf4;
        }
        
        .validation-item.failed {
            border-left: 4px solid #ef4444;
            background: #fef2f2;
        }
        
        .validation-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        
        .validation-type {
            font-weight: 600;
            font-size: 0.85rem;
            color: #374151;
            font-family: 'Courier New', monospace;
        }
        
        .validation-status {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .validation-status.passed {
            color: #059669;
        }
        
        .validation-status.failed {
            color: #dc2626;
        }
        
        .validation-icon {
            font-size: 1rem;
        }
        
        .validation-details {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            padding: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .validation-details-label {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 0.25rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .validation-details-content {
            font-size: 0.8rem;
            color: #374151;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
        }
        
        .validation-message {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 4px;
            padding: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .validation-message-icon {
            font-size: 0.9rem;
            flex-shrink: 0;
        }
        
        .validation-message-text {
            font-size: 0.8rem;
            color: #1e40af;
            line-height: 1.4;
        }
        
        .turn-metrics-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            background: #e0e7ff;
            border: 1px solid #a5b4fc;
            border-radius: 4px;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            color: #3730a3;
            font-weight: 500;
        }
        
        .validation-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.15rem;
            cursor: pointer;
            padding: 0.15rem 0.35rem;
            border-radius: 3px;
            font-size: 0.7rem;
            transition: background 0.2s;
        }
        
        .validation-badge:hover {
            opacity: 0.8;
        }
        
        .validation-badge.passed {
            background: #d1fae5;
            color: #065f46;
        }
        
        .validation-badge.failed {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .badge-icon {
            font-size: 0.85rem;
        }
        
        .badge-label {
            font-size: 0.65rem;
            font-weight: 600;
        }
        
        /* Media Content Styles */
        .media-summary-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.5rem;
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            margin-left: 0.5rem;
        }
        
        .media-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .media-badge.image {
            background: #e6f7ff;
            color: #0066cc;
        }
        
        .media-badge.audio {
            background: #fff0f6;
            color: #c41d7f;
        }
        
        .media-badge.video {
            background: #f6ffed;
            color: #389e0d;
        }
        
        .media-items {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #e2e8f0;
        }
        
        .media-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            background: #f8f9fa;
            border-radius: 0.5rem;
            border: 1px solid #e2e8f0;
        }
        
        .media-item.loaded {
            background: #f0fdf4;
            border-color: #86efac;
        }
        
        .media-item.error {
            background: #fef2f2;
            border-color: #fca5a5;
        }
        
        .media-item.not-loaded {
            background: #fefce8;
            border-color: #fde047;
        }
        
        .media-icon {
            font-size: 1.5rem;
            line-height: 1;
            flex-shrink: 0;
        }
        
        .media-info {
            flex: 1;
            min-width: 0;
        }
        
        .media-type {
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #64748b;
            margin-bottom: 0.25rem;
        }
        
        .media-source {
            font-size: 0.875rem;
            color: #1e293b;
            word-break: break-all;
            margin-bottom: 0.25rem;
        }
        
        .media-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.75rem;
            color: #64748b;
        }
        
        .media-status {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
            flex-shrink: 0;
        }
        
        .media-status.loaded {
            color: #16a34a;
        }
        
        .media-status.error {
            color: #dc2626;
        }
        
        .media-status.not-loaded {
            color: #ca8a04;
        }

        /* Audio Player Styles */
        .audio-player {
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: #f1f5f9;
            border-radius: 0.5rem;
        }

        .audio-player audio {
            width: 100%;
            height: 36px;
        }

        .audio-not-playable {
            margin-top: 0.5rem;
            padding: 0.25rem 0.5rem;
            background: #fef3c7;
            border: 1px solid #fcd34d;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            color: #92400e;
            font-style: italic;
        }

        /* A2A Agent tool call styling */
        .tool-call-name.agent {
            background: linear-gradient(135deg, #0d9488, #7c3aed);
            color: white;
            padding: 0.15rem 0.5rem;
            border-radius: 0.25rem;
        }

        .tool-response-name.agent {
            background: linear-gradient(135deg, #0d9488, #7c3aed);
            color: white;
            padding: 0.15rem 0.5rem;
            border-radius: 0.25rem;
        }

        .agent-icon {
            margin-right: 0.25rem;
        }

        /* Workflow transition tool call styling */
        .tool-call-name.workflow {
            background: linear-gradient(135deg, #d97706, #ea580c);
            color: white;
            padding: 0.15rem 0.5rem;
            border-radius: 0.25rem;
        }

        .tool-response-name.workflow {
            background: linear-gradient(135deg, #d97706, #ea580c);
            color: white;
            padding: 0.15rem 0.5rem;
            border-radius: 0.25rem;
        }

        .workflow-icon {
            margin-right: 0.25rem;
        }

        /* A2A Agent Cards Section */
        .a2a-agents-section {
            margin-top: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            overflow: hidden;
        }

        .a2a-agents-header {
            background: linear-gradient(135deg, #f0fdfa, #f5f3ff);
            padding: 0.75rem 1rem;
            font-weight: 600;
            font-size: 0.9rem;
            color: #1e293b;
            border-bottom: 1px solid #e2e8f0;
        }

        .a2a-agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 0.75rem;
            padding: 0.75rem;
        }

        .a2a-agent-card {
            border: 1px solid #e2e8f0;
            border-left: 3px solid #7c3aed;
            border-radius: 0.375rem;
            padding: 0.75rem;
            background: white;
        }

        .a2a-agent-name {
            font-weight: 600;
            font-size: 0.9rem;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }

        .a2a-agent-description {
            font-size: 0.8rem;
            color: #64748b;
            margin-bottom: 0.5rem;
        }

        .a2a-skills-list {
            border-top: 1px solid #f1f5f9;
            padding-top: 0.5rem;
        }

        .a2a-skill-item {
            font-size: 0.78rem;
            color: #475569;
            padding: 0.2rem 0;
        }

        .a2a-skill-name {
            font-weight: 500;
        }

        .a2a-skill-desc {
            color: #94a3b8;
        }

        .a2a-skill-tag {
            display: inline-block;
            background: #f1f5f9;
            color: #7c3aed;
            font-size: 0.7rem;
            padding: 0.1rem 0.35rem;
            border-radius: 0.2rem;
            margin-left: 0.25rem;
        }

        /* Validation UI Styles - Deprecated (kept for backwards compatibility) */
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <svg class="header-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128" fill="none">
                <defs>
                    <linearGradient id="lg1" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#fff" stop-opacity="0.95"/>
                        <stop offset="100%" stop-color="#e0d4ff" stop-opacity="0.9"/>
                    </linearGradient>
                    <linearGradient id="lg2" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#e0d4ff" stop-opacity="0.9"/>
                        <stop offset="100%" stop-color="#c4b5fd" stop-opacity="0.85"/>
                    </linearGradient>
                </defs>
                <path d="M24 32 L48 64 L24 96" stroke="url(#lg1)" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                <rect x="60" y="28" width="44" height="20" rx="4" fill="url(#lg1)"/>
                <rect x="60" y="54" width="44" height="20" rx="4" fill="url(#lg2)"/>
                <rect x="60" y="80" width="44" height="20" rx="4" fill="#c4b5fd" fill-opacity="0.85"/>
            </svg>
            <h1>{{.Title}}</h1>
        </div>
        <div class="subtitle">Generated on {{.GeneratedAt.Format "January 2, 2006 at 3:04 PM"}}</div>
    </div>
    
    <div class="container">
        <div class="summary">
            <h2>Summary</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">{{.Summary.TotalRuns}}</div>
                    <div class="stat-label">Total Runs</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{formatPercent .Summary.SuccessfulRuns .Summary.TotalRuns}}</div>
                    <div class="stat-label">Success Rate</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{formatCost .Summary.TotalCost}}</div>
                    <div class="stat-label">Total Cost</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{.Summary.TotalTokens}}</div>
                    <div class="stat-label">Total Tokens</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{.Summary.AvgLatency}}</div>
                    <div class="stat-label">Avg Latency</div>
                </div>
            </div>
            
            {{if or (gt .Summary.TotalImages 0) (gt .Summary.TotalAudio 0) (gt .Summary.TotalVideo 0)}}
            <h3 style="margin-top: 2rem; margin-bottom: 1rem; font-size: 1.2rem; color: #2d3748;">Media Content</h3>
            <div class="stats-grid">
                {{if gt .Summary.TotalImages 0}}
                <div class="stat-card">
                    <div class="stat-number">üñºÔ∏è {{.Summary.TotalImages}}</div>
                    <div class="stat-label">Images</div>
                </div>
                {{end}}
                {{if gt .Summary.TotalAudio 0}}
                <div class="stat-card">
                    <div class="stat-number">üéµ {{.Summary.TotalAudio}}</div>
                    <div class="stat-label">Audio Files</div>
                </div>
                {{end}}
                {{if gt .Summary.TotalVideo 0}}
                <div class="stat-card">
                    <div class="stat-number">üé¨ {{.Summary.TotalVideo}}</div>
                    <div class="stat-label">Videos</div>
                </div>
                {{end}}
                <div class="stat-card">
                    <div class="stat-number">‚úÖ {{.Summary.MediaLoadSuccess}}</div>
                    <div class="stat-label">Loaded</div>
                </div>
                {{if gt .Summary.MediaLoadErrors 0}}
                <div class="stat-card">
                    <div class="stat-number" style="color: #dc2626;">‚ùå {{.Summary.MediaLoadErrors}}</div>
                    <div class="stat-label">Errors</div>
                </div>
                {{end}}
                {{if gt .Summary.TotalMediaSize 0}}
                <div class="stat-card">
                    <div class="stat-number">{{formatBytes .Summary.TotalMediaSize}}</div>
                    <div class="stat-label">Total Size</div>
                </div>
                {{end}}
            </div>
            {{end}}
        </div>
        
        {{range $scenarioIdx, $scenarioGroup := .ScenarioGroups}}
        <div class="scenario-group" id="scenario-{{$scenarioGroup.ScenarioID}}">
            <div class="scenario-header" onclick="toggleScenario('scenario-{{$scenarioGroup.ScenarioID}}')">
                <span class="collapse-icon">‚ñº</span>
                <div class="scenario-title">{{$scenarioGroup.ScenarioID}}</div>
            </div>
            <div class="scenario-content">
                <div class="matrix-section" style="box-shadow: none; margin-bottom: 1rem;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 1rem; color: #4a5568;">Provider √ó Region Matrix</h3>
                    <table class="matrix-table">
                        <thead>
                            <tr>
                                <th>Provider / Region</th>
                                {{range $scenarioGroup.Regions}}
                                <th>{{.}}</th>
                                {{end}}
                            </tr>
                        </thead>
                        <tbody>
                            {{range $i, $providerRow := $scenarioGroup.Matrix}}
                            <tr>
                                <th>{{index $scenarioGroup.Providers $i}}</th>
                                {{range $providerRow}}
                                <td>
                                    <div class="matrix-cell {{statusClass .Successful .Errors}}" onclick="scrollToResult('{{.Provider}}', '{{.Region}}', '{{$scenarioGroup.ScenarioID}}')">
                                        <div class="scenario-count">{{if gt .Scenarios 0}}‚úì{{else}}-{{end}}</div>
                                        {{if gt .Scenarios 0}}
                                        {{if gt .Errors 0}}
                                        <div class="success-rate">Failed</div>
                                        {{else}}
                                        <div class="success-rate">Success</div>
                                        {{end}}
                                        <div class="cost-info">{{formatCost .Cost}}</div>
                                        {{else}}
                                        <div class="success-rate">No runs</div>
                                        {{end}}
                                    </div>
                                </td>
                                {{end}}
                            </tr>
                            {{end}}
                        </tbody>
                    </table>
                </div>
                
                <div class="results-section" style="box-shadow: none; padding: 0;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 1rem; color: #4a5568;">Results</h3>
                    {{range $resultIdx, $result := $scenarioGroup.Results}}
                    <div class="result-card" id="result-{{$result.ProviderID}}-{{$result.Region}}-{{$result.ScenarioID}}">
                        <div class="result-header" onclick="toggleResult('result-{{$result.ProviderID}}-{{$result.Region}}-{{$result.ScenarioID}}')">
                            <div class="result-header-left">
                                <span class="collapse-icon">‚ñº</span>
                                <div class="result-title">{{$result.ProviderID}} - {{$result.Region}}</div>
                            </div>
                            <div class="result-status {{if $result.Error}}error{{else}}success{{end}}">
                                {{if $result.Error}}Error{{else}}Success{{end}}
                            </div>
                        </div>
                        <div class="result-content">
                            <div class="conversation">
                                {{range $msgIdx, $msg := $result.Messages}}
                                {{$assertions := getAssertions $msg.Meta}}
                                {{$validators := getValidators $msg}}
                                {{$hasAssertions := hasAssertions $msg.Meta}}
                                {{$hasValidators := hasValidators $msg}}
                                {{$hasRawRequest := false}}
                                {{$hasAvailableTools := false}}
                                {{if $msg.Meta}}
                                    {{$metaMap := $msg.Meta}}
                                    {{if $metaMap}}
                                        {{if index $metaMap "_llm_raw_request"}}
                                            {{$hasRawRequest = true}}
                                        {{end}}
                                        {{if index $metaMap "_available_tools"}}
                                            {{$hasAvailableTools = true}}
                                        {{end}}
                                    {{end}}
                                {{end}}
                                {{$assertionsFailed := not (assertionsPassed $assertions)}}
                                {{$validatorsFailed := not (validatorsPassed $validators)}}
                                {{$hasFailed := or $assertionsFailed $validatorsFailed}}
                                <div class="turn {{$msg.Role}}{{if $hasFailed}} has-failures{{end}}">
                                    <div class="turn-header">
                                        <div class="turn-role">{{$msg.Role}}</div>
                                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                                            {{/* Show persona indicator for self-play user turns */}}
                                            {{if and (eq $msg.Role "user") $result.PersonaID}}
                                            <span class="ai-indicator" title="Self-Play Persona">
                                                <span class="ai-icon">ü§ñ</span>
                                                <span class="persona-name">{{$result.PersonaID}}</span>
                                            </span>
                                            {{end}}
                                            {{if or $msg.LatencyMs $msg.CostInfo $hasRawRequest}}
                                            <span class="turn-metrics-badge" title="Turn {{add $msgIdx 1}} metrics">
                                                {{if $msg.LatencyMs}}‚è±Ô∏è {{$msg.LatencyMs}}ms{{end}}
                                                {{if $msg.CostInfo}}
                                                {{if $msg.LatencyMs}} | {{end}}üéØ {{$msg.CostInfo.InputTokens}}‚Üí{{$msg.CostInfo.OutputTokens}} | üí∞ {{formatCost $msg.CostInfo.TotalCost}}
                                                {{end}}
                                                {{if $hasRawRequest}}
                                                {{if or $msg.LatencyMs $msg.CostInfo}} | {{end}}<span style="cursor: pointer;" onclick="toggleRawRequest('{{$result.RunID}}-{{$msgIdx}}')" title="Click to view raw LLM request">üêõ</span>
                                                {{end}}
                                            </span>
                                            {{end}}
                                            {{if $hasAssertions}}
                                            <span class="validation-badge {{if assertionsPassed $assertions}}passed{{else}}failed{{end}}" 
                                                  onclick="toggleValidations('assertions-{{$result.RunID}}-{{$msgIdx}}')" 
                                                  title="Click to {{if assertionsPassed $assertions}}view{{else}}review{{end}} assertions">
                                                <span class="badge-icon">{{if assertionsPassed $assertions}}‚úì{{else}}‚úó{{end}}</span>
                                                <span class="badge-label">A</span>
                                            </span>
                                            {{end}}
                                            {{if $hasValidators}}
                                            <span class="validation-badge {{if validatorsPassed $validators}}passed{{else}}failed{{end}}" 
                                                  onclick="toggleValidations('validators-{{$result.RunID}}-{{$msgIdx}}')" 
                                                  title="Click to {{if validatorsPassed $validators}}view{{else}}review{{end}} validators">
                                                <span class="badge-icon">{{if validatorsPassed $validators}}‚úì{{else}}‚úó{{end}}</span>
                                                <span class="badge-label">V</span>
                                            </span>
                                            {{end}}
                                        </div>
                                    </div>
                                    
                                    {{if $hasAssertions}}
                                    <div class="validations-section" id="assertions-{{$result.RunID}}-{{$msgIdx}}">
                                        <div class="validations-header">Assertions</div>
                                        {{if hasAssertionResults $assertions}}
                                        {{/* New format: iterate over results array */}}
                                        {{range $assertion := getAssertionResults $assertions}}
                                        <div class="validation-item {{if getOK $assertion}}passed{{else}}failed{{end}}">
                                            <div class="validation-header">
                                                <div class="validation-type">{{getAssertionType $assertion}}</div>
                                                <div class="validation-status {{if getOK $assertion}}passed{{else}}failed{{end}}">
                                                    <span class="validation-icon">{{if getOK $assertion}}‚úì{{else}}‚úó{{end}}</span>
                                                    {{if getOK $assertion}}Passed{{else}}Failed{{end}}
                                                </div>
                                            </div>
                                            {{$message := getMessage $assertion}}
                                            {{if $message}}
                                            <div class="validation-message">
                                                <div class="validation-message-icon">‚ÑπÔ∏è</div>
                                                <div class="validation-message-text">{{$message}}</div>
                                            </div>
                                            {{end}}
                                            {{$details := getDetails $assertion}}
                                            {{if $details}}
                                            <div class="validation-details">
                                                <div class="validation-details-label">Details</div>
                                                <div class="validation-details-content">{{prettyJSON $details}}</div>
                                            </div>
                                            {{end}}
                                        </div>
                                        {{end}}
                                        {{else}}
                                        {{/* Legacy format: iterate over map */}}
                                        {{range $name, $assertion := $assertions}}
                                        <div class="validation-item {{if getOK $assertion}}passed{{else}}failed{{end}}">
                                            <div class="validation-header">
                                                <div class="validation-type">{{$name}}</div>
                                                <div class="validation-status {{if getOK $assertion}}passed{{else}}failed{{end}}">
                                                    <span class="validation-icon">{{if getOK $assertion}}‚úì{{else}}‚úó{{end}}</span>
                                                    {{if getOK $assertion}}Passed{{else}}Failed{{end}}
                                                </div>
                                            </div>
                                            {{$message := getMessage $assertion}}
                                            {{if $message}}
                                            <div class="validation-message">
                                                <div class="validation-message-icon">‚ÑπÔ∏è</div>
                                                <div class="validation-message-text">{{$message}}</div>
                                            </div>
                                            {{end}}
                                            {{$details := getDetails $assertion}}
                                            {{if $details}}
                                            <div class="validation-details">
                                                <div class="validation-details-label">Details</div>
                                                <div class="validation-details-content">{{prettyJSON $details}}</div>
                                            </div>
                                            {{end}}
                                        </div>
                                        {{end}}
                                        {{end}}
                                    </div>
                                    {{end}}
                                    
                                    {{if $hasValidators}}
                                    <div class="validations-section" id="validators-{{$result.RunID}}-{{$msgIdx}}">
                                        <div class="validations-header">Validators</div>
                                        {{range $name, $validator := $validators}}
                                        <div class="validation-item {{if getOK $validator}}passed{{else}}failed{{end}}">
                                            <div class="validation-header">
                                                <div class="validation-type">{{$name}}</div>
                                                <div class="validation-status {{if getOK $validator}}passed{{else}}failed{{end}}">
                                                    <span class="validation-icon">{{if getOK $validator}}‚úì{{else}}‚úó{{end}}</span>
                                                    {{if getOK $validator}}Passed{{else}}Failed{{end}}
                                                </div>
                                            </div>
                                            {{$details := getDetails $validator}}
                                            {{if $details}}
                                            <div class="validation-details">
                                                <div class="validation-details-label">Details</div>
                                                <div class="validation-details-content">{{prettyJSON $details}}</div>
                                            </div>
                                            {{end}}
                                        </div>
                                        {{end}}
                                    </div>
                                    {{end}}
                                    
                                    {{if ne $msg.Role "tool"}}
                                    <div class="turn-content">{{renderMessageContent $msg}}</div>
                                    {{end}}
                                    {{if $msg.ToolCalls}}
                                    <div class="tool-calls">
                                        {{range $toolIdx, $toolCall := $msg.ToolCalls}}
                                        <div class="tool-call">
                                            <div class="tool-call-header" onclick="toggleToolContent(this)">
                                                <span class="tool-call-name{{if isAgentTool $toolCall.Name}} agent{{else if isWorkflowTool $toolCall.Name}} workflow{{end}}">{{if isAgentTool $toolCall.Name}}<span class="agent-icon">ü§ñ</span>{{else if isWorkflowTool $toolCall.Name}}<span class="workflow-icon">‚ö°</span>{{end}}{{$toolCall.Name}}</span>
                                                <span class="tool-call-id">{{$toolCall.ID}}</span>
                                                <span class="tool-call-toggle">‚ñ∂</span>
                                            </div>
                                            {{if $toolCall.Args}}
                                            <div class="tool-call-args">
                                                <div class="tool-call-args-label">Arguments:</div>
                                                <div class="json-content">{{prettyJSON $toolCall.Args}}</div>
                                            </div>
                                            {{end}}
                                        </div>
                                        {{end}}
                                    </div>
                                    {{end}}
                                    {{if $hasAvailableTools}}
                                    <details class="available-tools-details">
                                        <summary class="tool-call-name">üîß Available Tools</summary>
                                        <div class="tool-call-args" style="margin-top: 0.5rem;">
                                            <div class="json-content">{{prettyJSON (index $msg.Meta "_available_tools")}}</div>
                                        </div>
                                    </details>
                                    {{end}}
                                    {{if $hasRawRequest}}
                                    <div class="raw-request-content" id="raw-{{$result.RunID}}-{{$msgIdx}}">
                                        <div class="tool-call">
                                            <div class="tool-call-header">
                                                <span class="tool-call-name">Raw LLM Request</span>
                                            </div>
                                            <div class="tool-call-args">
                                                <div class="tool-call-args-label">Request Data:</div>
                                                <div class="json-content">{{prettyJSON (index $msg.Meta "_llm_raw_request")}}</div>
                                            </div>
                                        </div>
                                    </div>
                                    {{end}}
                                    {{if eq $msg.Role "tool"}}
                                    <div class="tool-response">
                                        <div class="tool-response-header" onclick="toggleToolResponse(this)">
                                            {{if $msg.ToolResult}}
                                            <span class="tool-response-name{{if isAgentTool $msg.ToolResult.Name}} agent{{else if isWorkflowTool $msg.ToolResult.Name}} workflow{{end}}">{{if isAgentTool $msg.ToolResult.Name}}<span class="agent-icon">ü§ñ</span>{{else if isWorkflowTool $msg.ToolResult.Name}}<span class="workflow-icon">‚ö°</span>{{end}}{{$msg.ToolResult.Name}}</span>
                                            <span class="tool-response-id">{{$msg.ToolResult.ID}}</span>
                                            {{else}}
                                            <span class="tool-response-name">Tool Response</span>
                                            {{end}}
                                            <span class="tool-response-toggle">‚ñ∂</span>
                                        </div>
                                        <div class="tool-response-content">
                                            <div class="tool-response-label">Response:</div>
                                            <div class="json-content">{{prettyJSON $msg.Content}}</div>
                                        </div>
                                    </div>
                                    {{if $msg.ToolResult}}
                                    {{if $msg.ToolResult.Error}}
                                    <div class="turn-error">
                                        <div class="error-icon">‚ö†Ô∏è</div>
                                        <div class="error-details">
                                            <div class="error-type">Tool Execution Failed</div>
                                            <div class="error-message">{{$msg.ToolResult.Error}}</div>
                                        </div>
                                    </div>
                                    {{end}}
                                    {{end}}
                                    {{end}}
                                </div>
                                {{end}}
                            </div>
                            
                            <div class="metadata">
                                <div class="meta-item">
                                    <div class="meta-label">Provider</div>
                                    <div class="meta-value">{{$result.ProviderID}}</div>
                                </div>
                                <div class="meta-item">
                                    <div class="meta-label">Region</div>
                                    <div class="meta-value">{{$result.Region}}</div>
                                </div>
                                <div class="meta-item">
                                    <div class="meta-label">Duration</div>
                                    <div class="meta-value">{{formatDuration $result.Duration}}</div>
                                </div>
                                <div class="meta-item">
                                    <div class="meta-label">Total Cost</div>
                                    <div class="meta-value">{{formatCost $result.Cost.TotalCost}}</div>
                                </div>
                                <div class="meta-item">
                                    <div class="meta-label">Tokens</div>
                                    <div class="meta-value">{{$result.Cost.InputTokens}}+{{$result.Cost.OutputTokens}}</div>
                                </div>
                                <div class="meta-item">
                                    <div class="meta-label">Turns</div>
                                    <div class="meta-value">{{len $result.Messages}}</div>
                                </div>
                            </div>
                            
                            {{if hasA2AAgents $result}}
                            {{renderA2AAgentCards $result.A2AAgents}}
                            {{end}}

                            {{if hasMediaOutputs $result}}
                            {{renderMediaOutputs $result.MediaOutputs}}
                            {{end}}
                            
                            {{if hasConversationAssertions $result}}
                            {{renderConversationAssertions (getConversationAssertionResults $result)}}
                            {{end}}
                            
                            {{if $result.Error}}
                            <div class="error-message">
                                <strong>Error:</strong> {{$result.Error}}
                            </div>
                            {{end}}
                        </div>
                    </div>
                    {{end}}
                </div>
            </div>
        </div>
        {{end}}
        
        <!-- Legacy matrix (deprecated) -->
        <div class="matrix-section" style="display: none;">
            <h2>Provider √ó Region Matrix (Legacy)</h2>
            <table class="matrix-table">
                <thead>
                    <tr>
                        <th>Provider / Region</th>
                        {{range .Regions}}
                        <th>{{.}}</th>
                        {{end}}
                    </tr>
                </thead>
                <tbody>
                    {{range $i, $providerRow := .Matrix}}
                    <tr>
                        <th>{{index $.Providers $i}}</th>
                        {{range $providerRow}}
                        <td>
                            <div class="matrix-cell {{statusClass .Successful .Errors}}">
                                <div class="scenario-count">{{.Scenarios}}</div>
                                {{if gt .Scenarios 0}}
                                <div class="success-rate">{{formatPercent .Successful .Scenarios}} success</div>
                                <div class="cost-info">{{formatCost .Cost}}</div>
                                {{else}}
                                <div class="success-rate">No runs</div>
                                {{end}}
                            </div>
                        </td>
                        {{end}}
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        
        <div class="results-section" style="display: none;">
            <h2>Individual Results (Legacy)</h2>
            <h2>Individual Results (Legacy)</h2>
            {{range $resultIdx, $result := .Results}}
            <div class="result-card" id="legacy-{{$result.ProviderID}}-{{$result.Region}}-{{$result.ScenarioID}}">
                <div class="result-header" onclick="toggleResult('legacy-{{$result.ProviderID}}-{{$result.Region}}-{{$result.ScenarioID}}')">
                    <div class="result-header-left">
                        <span class="collapse-icon">‚ñº</span>
                        <div class="result-title">{{$result.RunID}}</div>
                    </div>
                    <div class="result-status {{if $result.Error}}error{{else}}success{{end}}">
                        {{if $result.Error}}Error{{else}}Success{{end}}
                    </div>
                </div>
            </div>
            {{end}}
        </div>
    </div>

    <script>
        function toggleScenario(scenarioId) {
            const group = document.getElementById(scenarioId);
            group.classList.toggle('collapsed');
        }
        
        function toggleResult(resultId) {
            const card = document.getElementById(resultId);
            const header = card.querySelector('.result-header');
            
            card.classList.toggle('collapsed');
            header.classList.toggle('collapsed');
        }

        function toggleRawRequest(turnId) {
            const content = document.getElementById('raw-' + turnId);
            if (content) {
                content.classList.toggle('expanded');
            }
        }

        function toggleValidations(validationId) {
            const section = document.getElementById(validationId);
            if (section) {
                section.classList.toggle('expanded');
            }
        }

        function toggleToolContent(header) {
            const toolCall = header.closest('.tool-call');
            const args = toolCall.querySelector('.tool-call-args');
            const toggle = header.querySelector('.tool-call-toggle');
            if (args) {
                args.classList.toggle('expanded');
            }
            if (toggle) {
                toggle.classList.toggle('expanded');
            }
        }

        function toggleToolResponse(header) {
            const response = header.closest('.tool-response');
            const content = response.querySelector('.tool-response-content');
            const toggle = header.querySelector('.tool-response-toggle');
            if (content) {
                content.classList.toggle('expanded');
            }
            if (toggle) {
                toggle.classList.toggle('expanded');
            }
        }

        function scrollToResult(provider, region, scenario) {
            const resultId = 'result-' + provider + '-' + region + '-' + scenario;
            const result = document.getElementById(resultId);
            if (result) {
                result.scrollIntoView({ behavior: 'smooth', block: 'start' });
                // Expand if collapsed
                if (result.classList.contains('collapsed')) {
                    toggleResult(resultId);
                }
                // Highlight briefly
                result.style.boxShadow = '0 0 20px rgba(99, 102, 241, 0.5)';
                setTimeout(() => {
                    result.style.boxShadow = '';
                }, 2000);
            }
        }

        function scrollToProvider(provider, region) {
            // Find the result that matches this provider and region
            const results = document.querySelectorAll('.result-card');
            for (const result of results) {
                const id = result.id;
                if (id.startsWith(provider + '-' + region + '-')) {
                    result.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    // Expand if collapsed
                    if (result.classList.contains('collapsed')) {
                        toggleResult(id);
                    }
                    // Highlight briefly
                    result.style.boxShadow = '0 0 20px rgba(99, 102, 241, 0.5)';
                    setTimeout(() => {
                        result.style.boxShadow = '';
                    }, 2000);
                    break;
                }
            }
        }
    </script>
</body>
</html>