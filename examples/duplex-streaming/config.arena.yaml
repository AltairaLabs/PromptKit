# yaml-language-server: $schema=https://promptkit.altairalabs.ai/schemas/latest/arena.json
#
# Duplex Streaming Demo
# Demonstrates Arena's duplex streaming capabilities for real-time,
# bidirectional audio conversations. This example showcases:
# - Duplex mode with continuous audio streaming
# - Self-play with TTS (text-to-speech) integration
# - Voice activity detection (VAD) for turn detection
# - Real-time conversation testing
#
apiVersion: promptkit.altairalabs.ai/v1alpha1
kind: Arena
metadata:
  name: duplex-streaming-demo

spec:
  # Prompt configurations
  prompt_configs:
    - id: voice-assistant
      file: prompts/voice-assistant.prompt.yaml
    - id: voice-assistant-tools
      file: prompts/voice-assistant-tools.prompt.yaml

  # Provider configurations
  providers:
    # Real providers for local testing (require API keys)
    - file: providers/gemini-2-flash.provider.yaml
    - file: providers/openai-gpt4o-realtime.provider.yaml
    # Mock provider for CI testing
    - file: providers/mock-duplex.provider.yaml
    # Mock provider with simulation (interruptions, session closures)
    - file: providers/mock-duplex-simulate.provider.yaml
    # Replay provider for deterministic playback of recorded sessions
    # - file: providers/replay-duplex.provider.yaml  # Disabled until we have a recording

  # Scenario definitions
  scenarios:
    - file: scenarios/duplex-basic.scenario.yaml
    - file: scenarios/duplex-selfplay.scenario.yaml
    - file: scenarios/duplex-selfplay-mock.scenario.yaml
    - file: scenarios/duplex-interactive.scenario.yaml
    - file: scenarios/duplex-tools.scenario.yaml
    - file: scenarios/duplex-replay.scenario.yaml

  # Tool definitions for voice assistant
  tools:
    - file: tools/get_weather.tool.yaml
    - file: tools/get_calendar_events.tool.yaml
    - file: tools/set_reminder.tool.yaml

  # Self-play configuration for simulated conversations
  self_play:
    enabled: true
    personas:
      - file: personas/curious-customer.persona.yaml
      - file: personas/technical-user.persona.yaml
      - file: personas/busy-professional.persona.yaml
    roles:
      - id: selfplay-user
        provider: mock-duplex  # Use mock for CI, switch to real provider for local testing

  # Default settings
  defaults:
    temperature: 0.7
    max_tokens: 1000
    seed: 42
    concurrency: 1  # Duplex scenarios should run sequentially
    output:
      dir: out
      formats:
        - json
        - html
      html:
        file: report.html
      recording:
        enabled: true
        dir: recordings
